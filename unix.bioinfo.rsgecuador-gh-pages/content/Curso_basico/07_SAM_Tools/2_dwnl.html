
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Descarga de secuencias &#8212; GNU/Linux para Bioinformática</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="4. Implementación" href="3_impl.html" />
    <link rel="prev" title="2. Instalación de herramientas" href="1_inst.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">GNU/Linux para Bioinformática</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../README.html">
   Inicio
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introducción a Unix y GNU/Linux
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Unix_GNU-Linux/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Unix_GNU-Linux/1_Conceptos_Unix_GNU_Linux.html">
   2. Conceptos Unix y GNU/Linux
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Unix_GNU-Linux/2_Shell_bash_emulador_terminal.html">
   3. Shell, bash, y emulador de terminal
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_Unix_GNU-Linux/3_Formas_instalacion_emulador_terminal_Bash.html">
   4. Formas de instalar emulador de terminal de Bash
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Jupyter Lab
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../02_JupyterLab/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_JupyterLab/0_terminal_primera.html">
   2. Organización de archivos duante el taller
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_JupyterLab/1_anaconda.html">
   3. Instalación de Anaconda, Jupyter Lab y Bash Kernel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_JupyterLab/2_notebooks.html">
   4. Creación de Jupyter Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_JupyterLab/3_vim.html">
   5. Primer encuentro con Vim
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Manejo de Terminal
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../03_Manejo_terminal/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03_Manejo_terminal/1_def.html">
   2. Bash como shell de GNU/Linux
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03_Manejo_terminal/2_terminal.html">
   3. Terminal: Interacción con la Shell en Linux, MacOS y Windows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03_Manejo_terminal/3_comandos.html">
   4. Comandos en la
   <code class="docutils literal notranslate">
    <span class="pre">
     shell
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03_Manejo_terminal/4_directorios.html">
   5. Directorios y archivos en UNIX: Parte 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03_Manejo_terminal/5_wildcards.html">
   6. Wildcards y Streams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03_Manejo_terminal/6_directorios_2.html">
   7. Directorios y archivos en UNIX: Parte 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03_Manejo_terminal/8_variables_amb.html">
   8. Variables de ambiente
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Procesamiento de ficheros, regex y pipes
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/1_Archivos_formatos_comunes_Bioinformatica.html">
   2. Archivos y formatos comunes en Bioinformática
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/2_Editores_de_texto.html">
   3. Editores de texto
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/3_Expresiones_regulares.html">
   4. Expresiones regulares (
   <em>
    regex
   </em>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/4_Grep.html">
   5. Grep
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/5_Sed.html">
   6. Sed
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/6_Cut_sort.html">
   7. Cut, sort
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/7_Pipes.html">
   8. Pipes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_Procesamiento_ficheros_regex_pipes/8_Respuestas_ejercicios.html">
   9. Respuestas ejercicios deber
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Ejercicios para procesamiento ficheros en bioinformática
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/1_Preprocesamiento_pdb.html">
   2. Preprocesamiento de archivo PDB antes de realizar dinámica molecular
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/2_Motivos_fasta.html">
   3. Búsqueda de motivos en archivo fasta de una secuencia de nucleótidos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/3_Info_multifasta_genomas.html">
   4. Extracción de información de archivo multifasta de genomas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/4_Info_multifasta_proteoma.html">
   5. Extracción de información de archivo multifasta de secuencias de aminoácidos (proteoma)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/5_Info_fastq.html">
   6. Extracción de información de archivos fastq
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/6_Info_microarray.html">
   7. Extracción de información de archivo de experimento de microarray
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/7_Sitios_restric.html">
   8. Búsqueda de sitios de restricción en archivos fasta de secuencias de nucleótidos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05_Ejercicios_procesamiento_ficheros_Bioinfo/8_Respuestas_ejercicios.html">
   9. Respuestas ejercicios deber
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Make
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../06_Make/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06_Make/1_Make.html">
   2. Make
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  SAMTools
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_inst.html">
   2. Instalación de herramientas
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. Descarga de secuencias
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_impl.html">
   4. Implementación
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  AWK
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/01_AWK/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/01_AWK/1_Conceptos_generales_variables_internas_awk.html">
   2. Conceptos generales, instalación y variables internas AWK
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/01_AWK/2_Estructura_programas_sintax_awk.html">
   3. Estructura de scripts y sintaxis AWK
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/01_AWK/3_Ejemplos_awk.html">
   4. Ejemplos generales y con enfoque en Bioinformática
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/01_AWK/4_Respuestas_ejercicios.html">
   5. Respuestas ejercicios deber
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Bash
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/02_Bash/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/02_Bash/1_bash.html">
   2. Scripts en Bash
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/02_Bash/2_bash.html">
   3. Lógica, condicionales y arreglos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/02_Bash/3_bash.html">
   4. Bucles for y while
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/02_Bash/4_bash.html">
   5. Funciones
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Git y GitHub
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/03_Git_GitHub/0_Resumen.html">
   1. Resumen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/03_Git_GitHub/1_Git.html">
   2. Git
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Curso_avanzado/03_Git_GitHub/2_GitHub.html">
   3. GitHub
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/Curso_basico/07_SAM_Tools/2_dwnl.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/RSG-Ecuador/unix.bioinfo.rsgecuador.git"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/RSG-Ecuador/unix.bioinfo.rsgecuador.git/issues/new?title=Issue%20on%20page%20%2Fcontent/Curso_basico/07_SAM_Tools/2_dwnl.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#genoma-de-referencia">
   3.1. Genoma de referencia
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecturas-de-genomas">
   3.2. Lecturas de genomas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recapitulacion">
   3.3. Recapitulación
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="descarga-de-secuencias">
<h1><span class="section-number">3. </span>Descarga de secuencias<a class="headerlink" href="#descarga-de-secuencias" title="Permalink to this headline">¶</a></h1>
<p>Para este ejercicio vamos a descargar el genoma de referencia del virus SARS-CoV-2 y lo usaremos como referencia para alinear secuencias de genomas de personas infectadas en Ecuador. Para ello, usaremos los comandos instalados anteriormente.</p>
<div class="note admonition">
<p class="admonition-title">Nota</p>
<p>Recuerda que no debes hacer esto en un jupyter notebook, sino solo desde una ventana de Terminal.</p>
</div>
<p>Debes tener aún tu carpeta donde guardas tus archivos para el curso. Abrela y entra, para allí trabajar.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/taller_unix/7_sam_tools
</pre></div>
</div>
<p>Antes vamos a instalar algunos paquetes de conda para que puedas hacer queries a la base de datos NCBI.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ conda install -n bash -c bioconda -y -c conda-forge -c bioconda -c defaults entrez-direct
$ conda activate bash
</pre></div>
</div>
<div class="section" id="genoma-de-referencia">
<h2><span class="section-number">3.1. </span>Genoma de referencia<a class="headerlink" href="#genoma-de-referencia" title="Permalink to this headline">¶</a></h2>
<p>El genoma de referencia reportado por NCBI se encuentra bajo el código de acceso <strong>NC_045512.2</strong>, como se puede ver en la <a class="reference external" href="https://www.ncbi.nlm.nih.gov/sars-cov-2/">página web oficial</a>. La misma secuencia también se encuentra bajo el código de acceso <strong>MN908947</strong>. Este genoma tiene un ensamblaje en la base de datos <code class="docutils literal notranslate"><span class="pre">Assemble</span></code> de NCBI. Vamos a buscarlo con un query mediante el comando <code class="docutils literal notranslate"><span class="pre">esearch</span></code>. Obtendremos datos en formato XML que podremos pasar con un pipe a <code class="docutils literal notranslate"><span class="pre">esummary</span></code> y <code class="docutils literal notranslate"><span class="pre">xtract</span></code> para conocer información sobre el ensamblaje como <em>AssemblyAccession, AssemblyStatus, SpeciesName</em>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ mkdir ref_genome
$ <span class="nb">cd</span> ref_genome
$ <span class="nb">echo</span> ASSEMBLY DATA &gt; covid_esearch.txt
$ esearch -db assembly -query <span class="s1">&#39;&quot;Severe acute respiratory syndrome coronavirus 2&quot; \  </span>
<span class="s1">        [Organism] AND (latest[filter] AND &quot;complete genome&quot;[filter] AND \ </span>
<span class="s1">        &quot;reference genome&quot;[filter] AND all[filter] NOT anomalous[filter])&#39;</span> <span class="p">|</span> <span class="se">\</span>
        esummary <span class="p">|</span> xtract -pattern DocumentSummary -element <span class="se">\</span>
        AssemblyAccession,AssemblyStatus,SpeciesName &gt;&gt; covid_esearch.txt
$ <span class="nb">echo</span> &gt;&gt; covid_esearch.txt
$ cat covid_esearch.txt

ASSEMBLY DATA
GCF_009858895.2	Complete Genome	Severe acute respiratory syndrome-related coronavirus
...
</pre></div>
</div>
<p>Ahora, con ese número de acceso para el ensamblaje vamos a buscar el acceso a la secuencia del genoma RefSeq. Podemos usar el código <code class="docutils literal notranslate"><span class="pre">GCF_009858895.2</span></code> directamente, pero también el comando <code class="docutils literal notranslate"><span class="pre">elink</span></code> para obtener el identificador único o URL al repositorio en la base de datos de NCBI.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">echo</span> REFSEQ GENOME DATA &gt;&gt; covid_esearch.txt
$ esearch -db assembly -query GCF_009858895.2 <span class="p">|</span> elink -target nucleotide -name <span class="se">\</span>
        assembly_nuccore_refseq <span class="p">|</span> esummary <span class="p">|</span> xtract -pattern DocumentSummary <span class="se">\</span>
        -element AccessionVersion,Title &gt;&gt; covid_esearch.txt
$ <span class="nb">echo</span> &gt;&gt; covid_esearch.txt
$ cat covid_esearch.txt

ASSEMBLY DATA
GCF_009858895.2	Complete Genome	Severe acute respiratory syndrome-related coronavirus

REFSEQ GENOME DATA
NC_045512.2	Severe acute respiratory syndrome coronavirus <span class="m">2</span> isolate Wuhan-Hu-1, <span class="nb">complete</span> genome
</pre></div>
</div>
<p>Ahora vamos a descargar la secuencia en formato <code class="docutils literal notranslate"><span class="pre">.fasta</span></code> con una pequeña variación al código de arriba solo utilizando <code class="docutils literal notranslate"><span class="pre">efetch</span></code>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ esearch -db assembly -query GCF_009858895.2 <span class="p">|</span> elink -target nucleotide -name <span class="se">\</span>
        assembly_nuccore_refseq <span class="p">|</span> efetch -format fasta &gt; NC_045512.2.fasta
$ head -n <span class="m">3</span> NC_045512.2.fasta

&gt;NC_045512.2 Severe acute respiratory syndrome coronavirus <span class="m">2</span> isolate Wuhan-Hu-1, <span class="nb">complete</span> genome
ATTAAAGGTTTATACCTTCCCAGGTAACAAACCAACCAACTTTCGATCTCTTGTAGATCTGTTCTCTAAA
CGAACTTTAAAATCTGTGTGGCTGTCACTCGGCTGCATGCTTAGTGCACTCACGCAGTATAATTAATAAC
</pre></div>
</div>
<p>Otra posible opción pudo ser solamente usar el código de acceso en la base de datos <code class="docutils literal notranslate"><span class="pre">Nucleotide</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ esearch -db nucleotide -query NC_045512.2 <span class="p">|</span> efetch -format fasta <span class="se">\</span>
        &gt; NC_045512.2.fasta
$ head -n <span class="m">3</span> NC_045512.2.fasta

&gt;NC_045512.2 Severe acute respiratory syndrome coronavirus <span class="m">2</span> isolate Wuhan-Hu-1, <span class="nb">complete</span> genome
ATTAAAGGTTTATACCTTCCCAGGTAACAAACCAACCAACTTTCGATCTCTTGTAGATCTGTTCTCTAAA
CGAACTTTAAAATCTGTGTGGCTGTCACTCGGCTGCATGCTTAGTGCACTCACGCAGTATAATTAATAAC
</pre></div>
</div>
</div>
<div class="section" id="lecturas-de-genomas">
<h2><span class="section-number">3.2. </span>Lecturas de genomas<a class="headerlink" href="#lecturas-de-genomas" title="Permalink to this headline">¶</a></h2>
<p>Las lecturas de los genomas en formato <code class="docutils literal notranslate"><span class="pre">.fastq</span></code> se encuentran en la base de datos SRA de NCBI. Es importante que hayas instalado las herramientas de línea de comando para SRA, ya que así será muy fácil descargar la información. Comprueba que tengas acceso al comando <code class="docutils literal notranslate"><span class="pre">prefetch</span></code> desde la Terminal. Este comando permite descargar datos del repositorio SRA en formato <code class="docutils literal notranslate"><span class="pre">.sra</span></code>. Para transformarlos a <code class="docutils literal notranslate"><span class="pre">.fastq</span></code> y muchas más opciones se puede utilizar el comando <code class="docutils literal notranslate"><span class="pre">fastq-dump</span></code>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ prefetch --help

Usage: prefetch <span class="o">[</span> options <span class="o">]</span> <span class="o">[</span> accessions<span class="o">(</span>s<span class="o">)</span>... <span class="o">]</span>

Parameters:

  accessions<span class="o">(</span>s<span class="o">)</span>                    list of accessions to process
...
</pre></div>
</div>
<p>Hay muchísimas nuevas entradas a la base de datos que se podrían utilizar. Para esta ocasión decidimos utilizar secuencias que se han reportado en Ecuador, bajo el código de acceso <strong>SRR13084565</strong>. Podemos hacer un query para verificar su origen.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ../
$ esearch -db sra -query SRR13084565 <span class="p">|</span> esummary <span class="p">|</span> xtract -pattern DocumentSummary <span class="se">\</span>
        -element Title, Platform instrument_model

SARS-CoV-2 whole genome sequences obtained from Ecuadorian patients	ILLUMINA
</pre></div>
</div>
<p>Ahora, para descargar las secuencias hay que utilizar los siguientes comandos:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ prefetch SRR13084565

<span class="m">2021</span>-05-12T12:06:07 prefetch.2.11.0: <span class="m">1</span><span class="o">)</span> Downloading <span class="s1">&#39;SRR13084565&#39;</span>...
<span class="m">2021</span>-05-12T12:06:32 prefetch.2.11.0:  HTTPS download succeed
<span class="m">2021</span>-05-12T12:06:33 prefetch.2.11.0:  <span class="s1">&#39;SRR13084565&#39;</span> is valid
<span class="m">2021</span>-05-12T12:06:33 prefetch.2.11.0: <span class="m">1</span><span class="o">)</span> <span class="s1">&#39;SRR13084565&#39;</span> was downloaded successfully
<span class="m">2021</span>-05-12T12:06:33 prefetch.2.11.0: <span class="s1">&#39;SRR13084565&#39;</span> has <span class="m">0</span> unresolved dependencies

$ fastq-dump SRR13084565

Read <span class="m">957330</span> spots <span class="k">for</span> SRR13084565
Written <span class="m">957330</span> spots <span class="k">for</span> SRR13084565

$ head -n <span class="m">1</span> SRR13084565.fastq

@SRR13084565.1 <span class="m">1</span> <span class="nv">length</span><span class="o">=</span><span class="m">301</span>
</pre></div>
</div>
<p>Es también posible hacerlo desde la página web, pero es menos divertido. Utilizamos estas lecturas porque su tamaño no es tan grande. Solo usa 184.2 Mb en la memoria. Usualmente las lecturas de nueva generación pueden contener gigas. Ahora, si deseas jugar con estas herramientas puedes usar el genoma humano y mapear lecturas del exoma, o usar el genoma de una planta. El cielo es el límite. Procura tener memoria en la computadora.</p>
<a class="reference internal image-reference" href="../../../_images/sra1.png"><img alt="./img/sra1.png" class="align-center" src="../../../_images/sra1.png" style="width: 750px;" /></a>
<a class="reference internal image-reference" href="../../../_images/sra2.png"><img alt="./img/sra2.png" class="align-center" src="../../../_images/sra2.png" style="width: 750px;" /></a>
</div>
<div class="section" id="recapitulacion">
<h2><span class="section-number">3.3. </span>Recapitulación<a class="headerlink" href="#recapitulacion" title="Permalink to this headline">¶</a></h2>
<p>Se descargado dos archivos desde las bases de datos de NCBI: el genoma de referencia del virus SARS-CoV-2 con código de acceso <strong>NC_045512.2</strong> en formato <code class="docutils literal notranslate"><span class="pre">.fasta</span></code> y lecturas de secuenciación de nueva generación de Ecuador con código de accesso <strong>SRR13084565</strong> en formato <code class="docutils literal notranslate"><span class="pre">.fastq</span></code>. Ahora utilizaremos estas secuencias para hacer un alineamiento y encontrar SNPs.</p>
<a class="reference internal image-reference" href="../../../_images/meme.jpeg"><img alt="./img/meme.jpeg" class="align-center" src="../../../_images/meme.jpeg" style="width: 350px;" /></a>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/Curso_basico/07_SAM_Tools"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="1_inst.html" title="previous page"><span class="section-number">2. </span>Instalación de herramientas</a>
    <a class='right-next' id="next-link" href="3_impl.html" title="next page"><span class="section-number">4. </span>Implementación</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By RSG Ecuador<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>